---
title: 【工程化】前端工程化笔记
tags:
  - 前端
  - 模块化
  - Webpack
excerpt: （TODO）模块化；Webpack
abbrlink: d27f652f
date: 2021-12-05 20:22:10
---

# 1. 模块化

## 1.1 模块化概述	

* 浏览器端的模块化规范：AMD、CMD
* 服务器端的模块化规范：CommonJS

* 大一统的模块化规范：ES6。在语法层面上定义了ES6模块化规范，是浏览器端和服务器端通用的模块化开发规范

## 1.2 ES6模块化规范

* 每个js文件都是一个独立的模块

### 1.2.1 默认导出

* 暴露模块成员使用 export 关键字

  ```js
  //m1.js
  
  let a = 100
  let b = 200
  let c = 300
  let func = function(){
      console.log('func')
  }
  export default{
      a,b,func
  }
  ```

* 每个模块只允许使用一次的export default { }

* 导入模块成员使用 import 关键字

  ```js
  //index.js
  
  import m1 from './m1';
  
  m1.func()
  ```

* import 后跟着模块的名字，可以任取，只要合法即可；from 后跟着路径（模块标识符）
* 如果导入的模块没有export default { }，不会报错，此时导入的是一个空对象{ }

### 1.2.2 按需导出

```js
import m1 from './m1';
```

上面的代码默认指向默认导出的成员，不会导入按需导出的成员

```js
//m1.js

let a = 100
let b = 200
let c = 300
let func = function(){
    console.log('func')
}

export default{
    a,b,func
}

export let s1 = 'q'
export let s2 = 'w'
export function fun(){
    console.log('fun')
}
```

```js
//index.js

import m1, { s1, s2 as ss2, fun } from "./m1";

console.log(m1);
console.log(s1);
console.log(ss2);
console.log(fun);
```

* 按需导入时可以使用as起别名

* 在每个模块中，可以使用多次按需导出

### 1.2.3 直接导入并执行模块代码

```js
//m2.js

for (let i = 0; i < 3; i++) {
    console.log(i);
}
```

```js
//index.js

import './m2'
```

index.js会导入m2.js中的代码并且全部执行一遍，不需要m2.js暴露成员

# 2. Webpack

##  2.1 Webpack的基本使用

### 2.1.1 基本配置

1. 运行npm install webpack webpack-cli -D 命令，安装 webpack 相关的包

2. 在项目的根目录中，创建名为 webpack.config.js 的webpack配置文件

3. 在webpack的配置文件中，初始化如下的基本配置

   ```js
   module.exports = {
       mode: "development",    //mode用来指定构建模式
   };
   ```

4. 在package.json配置文件中的script结点下，新增dev脚本如下：

   ```json
    "dev":"webpack"
   ```

5. 终端运行 npm run dev 命令

### 2.1.2 配置打包的入口和出口

webpack 4.x版本中约定：

* 打包的入口文件为：src -> index.js
* 打包的输出文件为：dist -> main.js

如果想要修改打包的入口和出口，可以在webpack.config.js中新增如下的配置信息

```
//node.js中专门操作路径的模块
const path = require("path");

module.exports = {
    //打包的入口文件的路径
    entry: path.join(__dirname, "./src/index.js"),
    output: {
        //输出文件的存放路径
        path: path.join(__dirname, "./dist"),
        //输出文件的名称
        filename: "bundle.js",
    },
};

```

### 2.1.3 配置自动打包功能

1. 运行 npm install webpack-dev-server -D命令，安装支持项目自动打包的工具

2. 修改package.json -> scripts 中的dev命令如下：

   ```js
   "scripts": {
       "dev": "webpack-dev-server"
   },
   ```

3. 修改index.html中

   ```html
    <script src="/bundle.js"></script>
   ```

4. 运行 npm run dev ，重新进行打包

## 2.2 Webpack中的加载器

通过loader打包非js模块

* webpack默认只能打包以js结尾的模块，其他非js结尾的模块js无法处理，需要调用loader加载器才可以正常打包，否则会报错。

* less-loader可以打包处理.less相关的文件
* sass-loader可以打包处理.scss相关的文件
* url-loader可以打包处理css中与url路径相关的文件

### 2.2.1 打包处理css文件

